# 演習概要
- 演習内容
  - 四則演算の結果を行う。
  - 環境変数を設定し、環境変数を読み取って計算に利用する。

- 演習目標
  - 四則演算の処理の書き方を理解する。
  - 環境変数の設定、読み取り方を理解する。
  - 以下のコマンドの使い方を理解する。
    - export
    - printenv


# 演習内容

## 課題1.　四則演算を行うシェルスクリプトの作成
以下の計算処理を行うシェルスクリプトのファイル(tr_6_1.sh)を作成・実行する。  
  - ２つのシェル変数VAR1,VAR2を設定し、任意の整数を与える。(ただしVAR2には0以外の整数を与えること ※1)
  - VAR1,VAR2を用いて以下の計算を行い、結果をターミナル上に表示する。
    - VAR1 + VAR2
    - VAR1 - VAR2
    - VAR1 * VAR2　(※2)
    - VAR1 / VAR2

※1. VAR2に0を入れるとゼロ除算によるエラーが発生するため。  
※2. 除算では少数点以下の表示は不要。(興味のある人は調べてやってみると良い)

## 課題2.　環境変数を読み取って四則演算を繰り返し行うシェルスクリプトの作成
以下の計算処理を行うシェルスクリプトのファイル(tr_6_2.sh)を作成する。  
  - 環境変数ENVVAR1を読み取って以下の計算を行い、結果をターミナル上に表示する。(環境変数ENVVAR1はターミナルでコマンドを実行して設定する。値は任意の整数とする。)
    - ENVVAR1に1～100までの数字を足す。(例：ENVVARが1の場合、答えは5051になる。)

# ヒント
## 課題1
<details><summary>講義資料参考ページ</summary><div>

- 四則演算
  - p83
</div></details>

<details><summary>変数の計算</summary><div>

下記のように書くことで数値を入れた変数同士の計算が可能

``` sh
VAR1=5
VAR2=3

echo $(($VAR1 + $VAR2))
```

上記をシェルスクリプトとして実行すると下記が出力される

```
8
```

</div></details>


## 課題2
<details><summary>講義資料参考ページ</summary><div>

- 環境変数
  - p38,p42
</div></details>

<details><summary>解くための指針</summary><div>

- 1～100までの数字の足し合わせ  
  直接スクリプト内に数字を書き込んで足していくのではなく、演習3の課題1で学んだループ回数を変数として扱うことができたことを活用する。
</div></details>


# 演習解答  

<details><summary>解答例</summary><div>

## 課題1.四則演算を行うシェルスクリプト　解答例  
シェルスクリプトファイル"tr_6_1.sh"をエディタから作成し、下記の内容を書き込む。  
ここでは計算に$((式))を使用しているが、exprやletを使用しても良い

``` sh
#!/bin/bash
VAR1=5 #任意の整数
VAR2=3 #任意の整数

echo $VAR1 + $VAR2 = $(($VAR1 + $VAR2))
echo $VAR1 - $VAR2 = $(($VAR1 - $VAR2))
echo $VAR1 \* $VAR2 = $(($VAR1 * $VAR2))
echo $VAR1 / $VAR2 = $(($VAR1 / $VAR2))
# 小数点の計算を行いたい場合(例:awkを使用)
## echo $VAR1 / $VAR2 = `echo "$VAR1 $VAR2" | awk '{print $1 / $2}'`
# 小数点の計算を行いたい場合(例:bcを使用)
## echo $VAR1 / $VAR2 = `echo "scale=5; $VAR1 / $VAR2" | bc`
```

<details><summary>課題1のシェルスクリプトの内容解説</summary><div>

- `$(($VAR1 + $VAR2))`　…　変数を含めた計算式は`$(($変数1 + $変数2))`のように記載する。講義資料p83を参照。
- `echo`を使い計算式を表示することで、何の計算を行ったかをわかりやすくしている。
</div></details>

tr_6_1.shを実行する。  

```
bash tr_6_1.sh
```

計算結果が表示されることを確認。  
(以下は上記の例の場合の表示)

``` sh
5 + 3 = 8
5 - 3 = 2
5 * 3 = 15
5 / 3 = 1
```

## 課題2.環境変数を読み取って四則演算を繰り返し行うシェルスクリプト　解答例  

exportコマンドを実行して環境変数をターミナルから設定する。  

```
export ENVVAR1=1
```

printenvコマンドを実行して環境変数が設定されたことを確認。  

```
printenv
```  

上記コマンドを実行すると、設定されている環境変数が全て出力される。  
環境変数の中に以下の表示があることを確認。  

```
ENVVAR1=1
```

備考…後の演習に出てくるパイプラインを使用し、`grep`コマンドを使うことでENVVAR1だけを特定して表示することが出来る。  
その場合、下記のようなコマンドとなる。  

```
printenv | grep ENVVAR1
```  

シェルスクリプトファイル"tr_6_2.sh"をエディタから作成し、下記の内容を書き込む。  

``` sh
#!/bin/bash
res=$ENVVAR1

for ((i=1; i<101; i++))
do
  res=$((res + i))
done

echo result = $res
```
<details><summary>課題2のシェルスクリプトの内容解説</summary><div>

- `((i=1; i<101; i++))`　…　演習3で学んだ繰り返しループを活用することで、インクリメントの計算が楽に行える。ここだとiは初期値1から始まり、繰り返しごとに1ずつ値が増えていき、101になった時点でループ処理が終了する。繰り返しごとに`res=$((res + i))`が行われるので、全ての繰り返し処理が終わった時に、1～100までの数字を足す計算が行われることになる。  
</div></details>


tr_6_2.shを実行する。  

`bash tr_6_2.sh`

計算結果が表示されることを確認。  
(以下は上記の例の場合の表示)

```
result = 5051
```

</div></details>

## [次の演習(演習7)](./演習7.md)