# 演習概要
- 演習内容
  - 与えられた値によって処理を分岐するシェルスクリプトを作成して実行する。
  - 直前の処理の終了ステータスに応じて処理を分岐するシェルスクリプトを作成して実行する。

- 演習目標
  - シェルスクリプトの変数の扱い方を理解する。
  - 以下のコマンドの使い方を理解する。
    - if
    - test
      - 略式test([])
    - cat
  - 終了ステータスについて理解する。

# 演習内容

## 課題1.変数の値によって出力が変わるシェルスクリプトの作成 
以下の内容を持つシェルスクリプトのファイル(tr_2_1.sh)を作成・実行し、変数の値によって出力が変わることを確認する。
  - シェル変数 "VAR"を設定し、値として0か1を与える。 
  - if文とtestコマンドを用いて変数"VAR"が0か1かを判定し、結果に応じてターミナル上に文字を表示する。
    - 判定結果により表示する文字は以下の通り。
      - "VAR"が0の場合…"OK"。
      - "VAR"が1の場合…"NG"。

## 課題2.コマンドの結果によって出力が変わるシェルスクリプトの作成 
以下の内容を持つシェルスクリプトのファイル(tr_2_2.sh)を作成・実行し、コマンドの結果によって出力が変わることを確認する。
  - catコマンドを用いて、"hoge.txt"を表示する。
    - ※hoge.txtはシェルスクリプトと同じディレクトリ上に作成する。コマンドの成否だけで判定するため"hoge.txt"の中身は空で良い。
  - if文とtestコマンドを用いて、catコマンドの終了ステータスを判定し、結果に応じてターミナル上に文字を表示する。
    - 判定結果により表示する文字は以下の通り。
      - catコマンドが正常に実行された(="hoge.txt"が存在する)場合…"OK"。
      - catコマンドが正常に実行されなかった(="hoge.txt"が存在しない)場合…"NG"。

# ヒント
## 課題1
<details><summary>講義資料参考ページ</summary><div>

- 変数
  - p36~41
- 条件分岐
  - p81~82
</div></details>

<details><summary>変数設定</summary><div>

- 変数を設定するには下記のようにシェルスクリプト内に記載する

```
VAR=0
```
</div></details>

<details><summary>testコマンドの条件指定</summary><div>

- 今回は変数VARが0と同じかを判定するため、講義資料p82の`数値1 - eq 数値2`を使用し以下のように記載する

``` sh
[ $VAR -eq 0 ]
```

</div></details>

</div></details>

<details><summary>ifコマンドとtestコマンドによる条件分岐</summary><div>

- 変数VARが0か講義資料p81の`if elif else fi`のうち`if else fi`を使用し以下のように記載する。  
  (elifはifの条件が真ではない時に、さらに条件分岐したいときにつかうもののため今回のように0か1かを判定したいだけのときは使用しない)

``` sh
if [ $VAR -eq 0 ]; then
  # OKを出力するコマンド
else
  # NGを出力するコマンド
fi
```

</div></details>

## 課題2
<details><summary>講義資料参考ページ</summary><div>

- 特殊変数
  - p39
</div></details>

<details><summary>終了ステータスの取得</summary><div>

- catコマンドの終了ステータスを取得するために講義資料p39に記載している特殊変数`$?`を使用する

</div></details>

<details><summary>testコマンドの条件指定</summary><div>

- 特殊変数`$?`の値が0、つまり成功かそれ以外を判定するために講義資料p82の`数値1 - eq 数値2`を使用し以下のように記載する

``` sh
[ $? -eq 0 ]
```

</div></details>

# 演習解答  

<details><summary>解答例</summary><div>

## 課題1.変数の値によって出力が変わるシェルスクリプトの作成　解答例  
シェルスクリプトファイル"tr_2_1.sh"をエディタから作成し、下記の内容を書き込む。  

``` sh
#!/bin/bash
VAR=0

if [ $VAR -eq 0 ]; then
  echo "OK"
else
  echo "NG"
fi
```

<details><summary>課題1のシェルスクリプトの内容解説</summary><div>

- `VAR=0` …シェル変数VARに値0を代入。講義資料ｐ37を参照
- `if 条件式 ;then else fi` …条件分岐。ifの後の条件式が真の場合thenの後に記載された処理が、偽の場合elseの後に記載された処理が実行される。講義資料p81参照。
- `[ $VAR -eq 0 ]`…条件指定。講義資料p82参照。
</div></details>
  
bashコマンドでtr_2_1.shを実行する。  

`bash tr_2_1.sh`

以下の内容がターミナル上に表示されていることを確認。  

```
OK
```

`tr_2_1.sh`内の`VAR=0`を`VAR=1`に書き換える。  

bashコマンドでtr_2_1.shを実行する。  

`bash tr_2_1.sh`

以下の内容がターミナル上に表示されていることを確認。  

```
NG
```

## 課題2.コマンドの結果によって出力が変わるシェルスクリプトの作成　解答例  

シェルスクリプトファイル"tr_2_2.sh"をエディタから作成し、下記の内容を書き込む。  

```　sh
#!/bin/bash
cat hoge.txt

if [ $? -eq 0 ]; then
  echo "OK"
else
  echo "NG"
fi
```

<details><summary>課題2のシェルスクリプトの内容解説</summary><div>

- `[ $? -eq 0 ]`…条件指定。`$?`は特殊変数で、直前のコマンドが成功している場合は値が0となる。講義資料p39を参照。
</div></details>


空ファイルを作成するtouchコマンドを実行して、hoge.txtを作成する。(エディタから直接からファイルを作成しても良い)

```
touch hoge.txt
```

bashコマンドでtr_2_2.shを実行する。  

```
bash tr_2_2.sh
```

以下の内容がターミナル上に表示されていることを確認。  

```
OK
```

ファイルを削除するrmコマンドを実行して、hoge.txtを削除する。

```
rm hoge.txt
```

bashコマンドでtr_2_2.shを実行する。  

```
bash tr_2_2.sh
```

以下の内容がターミナル上に表示されていることを確認。  

```
cat: hoge.txt: No such file or directory
NG
```

</div></details>

## [次の演習(演習3)](./演習3.md)